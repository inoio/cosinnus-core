{% extends "cosinnus/base.html" %}
{% load i18n thumbnail cosinnus_tags %}

{% block page_title %}{% trans "Dashboard" %}{% endblock %}

{% block og_url %}{{ block.super }}{% endblock og_url %}
{% block og_title %}{{ block.super }}{% endblock %}
{% block og_image %}{{ block.super }}{% endblock %}
{% block og_description %}{{ block.super }}{% endblock %}

{% block og_meta_attributes %}
    {{ block.super }}
{% endblock %}

{% block body_attributes %}class="v2-dashboard-body"{% endblock body_attributes %}

{% block container_classes %}v2-dashboard loading{% endblock container_classes %}
{% block container_attributes %}data-active-panel="2"{% endblock container_attributes %}

{% block main_page %}
	{% include 'cosinnus/common/internet_explorer_not_supported.html' %}

    {% comment %} Some settings for the dashboard are initialized in the extraheader, and passed in a router.js, and uses a lot of
                   the default settings defined in map.js.  
                  We don't pass a `settings param here because we use all the default ones.`      
    {% endcomment %}
    
    <div class="dashboard-mobile-header mobile-only">
    	<a class="active-panel-1" onclick="$('.v2-dashboard').attr('data-active-panel', 1);">
    		{% trans "Overview" %}
		</a>
    	<a class="active-panel-2" onclick="$('.v2-dashboard').attr('data-active-panel', 2);">
    		{% trans "Timeline" %}
		</a>
    	<a class="active-panel-3" onclick="$('.v2-dashboard').attr('data-active-panel', 3);">
    		{% trans "Contents" %}
		</a>
    </div>
        
	<div class="dashboard-left-bar dashboard-column visible-panel-1">
		<div class="dashboard-left-bar-content" style="display: none;">
			<div class="group-widget-root">
			</div>
			<div class="ideas-widget-root">
			</div>
			<div class="map-widget square-widget">
					<div class="widget-content square-content">
						<h2 class="headline">{% trans "Close to me" %}</h2>
					</div>
					<a href="/map/" class="square-content hover-link">
						{% trans "Show large map" %} 
					</a>
			</div>
			<div class="legal-links">
				{% include 'cosinnus/v2/dashboard/tos_links.html' %}
			</div>
		</div>
	</div>
		
	<div class="dashboard-center-bar dashboard-column visible-panel-2">
		
		<div class="dashboard-news-create-frame">
			<h2 class="headline">{% trans "News" %}</h2>
			
			<div class="news-textbox-frame">
				<div class="news-textbox" data-toggle="modal" data-target="#write-news-modal">
					<span class="news-textbox-icon">
						<i class="fa fa-fw fa-pencil"></i>
					</span>
					{% trans "What's the latest news?" %}
				</div>
			</div>
			{% include 'cosinnus_note/note_form_modal.html' with group=forum_group form=note_form %}
		</div>
		
		<div class="timeline-root">
			{# timeline-view.js #}
		</div>
		
	</div>
		
	<div class="dashboard-right-bar dashboard-column visible-panel-3">
		<div class="dashboard-right-bar-content" style="display: none;">
			<div class="typed-widgets-root">
			</div>
		</div>
	</div>
		
	
    
    <script>
	    $('html').on('init:client', function () {
	        console.log('got init client, now init:module-full-routed');
	        Backbone.mediator.publish('init:module-user-dashboard', {{ user_dashboard_options_json|safe }});
	    });
	</script>

{% endblock main_page %}

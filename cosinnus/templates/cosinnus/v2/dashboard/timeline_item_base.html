{% load i18n cosinnus_tags %}

<div class="timeline-item {% block container_class %}{% endblock %}">
	<div class="header-dropdown dropdown">
	</div>
	
	<div class="timeline-item-row header flex-row">
		<div class="avatar">
			<a href="{{ item.creator|profile_url }}">
				{% include "cosinnus/user/user_avatar_image.html" with user=item.creator %}
			</a>
		</div>
		<div class="header-info flex-grow">
			<div class="item-info">
				<a href="{{ item.creator|profile_url }}">
					{{ item.creator|full_name }}
				</a>
				<span class="highlighted-text plain-links">
					<a href="{{ item.get_absolute_url }}">
						{% block creation_label %}{% endblock %}
					</a>
				</span>
			</div>
			<div class="item-date pale-color">
				<a href="{{ item.get_absolute_url }}">
					<span class="moment-data-date" data-date="{{ item.created|date:'c' }}" title="{{ item.created|date:'r' }}"></span>
				</a>
			</div>
		</div>
		<div class="header-context pale-color">
			{% if item.group and item.group.is_default_user_group %}
				<a href="{{ item.group.portal.get_absolute_url }}">
					</i><span>{{ item.group.portal.name }}</span>
				</a>
			{% elif item.group %}
				<a href="{{ item.group.get_absolute_url }}">
					<i class="fa fa-fw {% if item.group.type == 0 %}fa-group{% else %}fa-sitemap{% endif %}">
					</i><span>{{ item.group.name }}</span>
				</a>
			{% else %}
				<a href="{{ item.portal.get_absolute_url }}">
					</i><span>{{ item.portal.name }}</span>
				</a>
			{% endif %}
		</div>
	</div>
	
	<div class="icon">
		<a href="{{ item.get_absolute_url }}">
			<i class="fa fa-fw {% block icon %}{% endblock %}"></i>
		</a>
	</div>
	
	<div class="timeline-item-row body">
		{% block title_frame %}
			<div class="title-frame">
				<div class="title">
					<a href="{{ item.get_absolute_url }}"> 
						{% block title %}{% endblock %}
					</a>
				</div>
				
				<div class="subtitle plain-links">
					{% block subtitle %}
						<span class="spacer-if-inbetween"></span>
						{% with location=item.media_tag.location %}
							{% if location %}
								<a href="{{ item.media_tag.location_url }}" target="_blank">{{ location }}</a>
							{% endif %}
						{% endwith %}
					{% endblock %}
				</div>
			</div>
		{% endblock %}
		{% block body_frame %}
			<div class="v2-textfield truncated-textfield truncated-textfield-large">
				{% block body %}{% endblock %}
			</div>
		{% endblock %}
	</div>
	
	{% block attached_images %}
		{% if item.attached_images %}
			<div class="timeline-item-row attachments">
				<span style="color:red">TODO: images!!!!!</span>
				{% comment %}  
				{% include 'cosinnus/v2/dashboard/timeline_attached_image_gallery.html'  %}
				{% endcomment %}
			</div>
		{% endif %}
	{% endblock %}
	
	{% block attached_objects %}
		{% if item.attached_objects.exists %}
			<div class="timeline-item-row attachments">
			    {% cosinnus_render_attached_objects item v2Style=True %}
			</div>
		{% endif %}
	{% endblock %}
	
	{% block tags %}
		{% with topics=item.media_tag.topics tags=item.media_tag.tags.all %}
			{% block upper_seperator %}
				{% if tags or topics %}
					<hr class="seperator" />
				{% endif %}
			{% endblock %}
			<div class="timeline-item-row meta-row text-small flex-row plain-links remove-if-empty">
				<div class="timeline-tags flex-grow">
					{% if topics %}
						<span>
							<i class="fa fa-fw fa-lightbulb-o"></i>
							{% render_cosinnus_topics topics %}
						</span>
					{% endif %}
					{% if tags %}
						<span>
							<i class="fa fa-fw fa-tag"></i>
							{% for tag in tags %}
								{{ tag }}{% if not forloop.last %}, {% endif %}
							{% endfor %}
						</span>
					{% endif %}
				</div>
				<div class="action-buttons">
					{% block action_buttons %}{% endblock %}
				</div>
			</div>
			{% if tags or topics %}
				<hr class="seperator" />
			{% endif %}
		{% endwith %}
	{% endblock %}
	
	{% block comments %}
		{% comment %} Include 'cosinnus/v2/dashboard/timeline_item_comments.html' in your implementing template! {% endcomment %}
		{% comment %}  
		
		{% endcomment %}
	{% endblock %}
	
</div>